・IP(Internet Protocol) インターネット通信するための規約,ルールのこと。L3で機能する。送信するデータを一定の長さごとに区切ってデータグラムという塊にして送信する。{新規IP(Intellectual Property)というと知的財産権のことであり、一般的にはこのほうがよく使うか？}

・IPヘッダ　IPパケットのヘッダ部分。郵便の封筒のように宛先や差出人のIPアドレスが記載されてる。内訳は先頭から、バージョン(4bit),ヘッダ長(4bit),サービスタイプ(8bit),データ長(16bit),識別番号(16bit),フラグ(3bit),フラグメントオフセット(13bit),生存時間{TTL}(8bit),プロトコル番号(8bit),ヘッダチェックサム(16bit),発信元IPアドレス(32bit),宛先IPアドレス(32bit),オプション(32bit単位で可変長),パディング(可変長)

[IHL](Internet Head Length)インターネットヘッダ長　IPヘッダの長さを表す。

[TOS](Type Of Service)　IPパケットの優先度など品質を決める情報。QoS処理用。
　[QoS](Quality of Service)　ネットワーク上で提供するサービスの品質のこと。ある特定のトラフィックを優先して転送する。例えばFTPデータと音声データが混在する時、音声を優先して転送させる。IntServ,DiffServ,ベストエフォート,３つの方式がある。

[Total Length]IPヘッダとデータを含めたパケット全体の長さ。

[Identification]識別番号　分割された個々のパケットには同じ番号にすることで、受信側で複数のパケットがあっても正しく組み立てられる。

[Frag]パケット分割における制御の情報。3bitの内訳は割愛https://www.infraexpert.com/study/tcpip1.html

[Flagment Offset]分割されたパケットが、元データのどこに位置しているかを表す。

[TTL](Time to Live)パケットが通信可能なルータの数。ルータを経由するたびに１減っていき、０になった時点でこのパケットを破棄する。{Tracertで使った}

[プロトコル番号]L4のプロトコルが何であるのかを表す情報。

[Header Checksum]ヘッダのチェックサムを表す情報。ヘッダにエラーがないかチェックする。

[Option]通常使用されないが、デバッグやテストをする際に使用される情報。32ビットの正数倍にならないことがある。

[Padding]通常使用されないが、オプションを使用したときにソレと合わせて32ビットの正数倍にする。水増しや詰め物という意味の英単語。


・ICMP(Internet Control Message Protocol)　IPのエラーや制御メッセージを転送するためのプロトコル。pingやtracerouteで利用される。{OSIでの階層で定義されない？}ネットワーク性能を低下させるために悪用されることがある。ICMPフラッド,Smurf攻撃,Ping of Death攻撃などのDDos攻撃。

　[ICMPフラッド]標的デバイスに対して大量のpingを送信してデバイスのリソースを枯渇させる攻撃
　
　[Smurf攻撃]標的デバイスに対してIPアドレスを偽装したICMPパケットを大量に送信してオーバーフローさせる。{メッチャ古いデバイスにしか効かないっぽい}

　[Ping of death]標的デバイスに受信不可能なサイズのpingを送信して、デバイスをクラッシュ,フリーズさせる。{古いデバイスにしか効かないっぽい}

・ICMPメッセージ　ICMPによって送信されるパケット。内訳はタイプ(8bit),コード(8bit),チェックサム(16bit),データ(可変長)
　[Type]ICMPメッセージの機能タイプの値
　[Code]ICMPメッセージの詳細な機能を表す
　[Checksum]エラーがないかチェックする
　[Data]ICMPのタイプにより長さが異なる。


・IPアドレス　インターネット上の住所。32ビットで構成される。自動で割り当てる動的IPと、常に同じ固定IPがある。グローバルIPで固定させるためにはISPと契約する必要がある。

　○オクテット　８ビットのこと。{昔１バイトは必ずしも８ビットではなかったことから現代でも使われる}

　○ネットワーク部　IPアドレスのうち、どのネットワークに属しているかを表す部分。

　○ホスト部　IPアドレスのうち、どのコンピュータかを表す部分。
　
　○クラス　ネットワークを構成するパソコンの台数に応じて分けられる区分。ABC分けされていたが、現代ではアドレス枯渇のため使われることがない。{ただしネットワーク部のIPアドレスの先頭ビットからどこに属するのかは判断できる}
　
　○プライベート(ローカル)IPアドレス　特定のネットワーク内で割り当てられるIPアドレス。別のネットワークでは同じローカルIP使うことも可能。IPアドレス枯渇防止のために1980年代以降に登場した。

　○グローバルIPアドレス 世界中で重複しないアドレス。インターネット上での住所。コレを全世界で管理するのがICANN。アジア,北米,ヨーロッパ内を管理するのがAPNIC。日本内を管理するのがJPNIC。通信事業者がISPとなる。

　[NAT](Network Address Translation)インターネット接続するときにローカルIPとグローバルIPを変換する仕組み。

・ネットワークアドレス　IPアドレスのうち、ホスト部の２進数表記が全て０のもの。どのネットワークであるかを表す。

・ブロードキャストアドレス　IPアドレスのうち、ホスト部の２進数表記が全て１のもの。コレに対して行うデータ転送がブロードキャストとなる。

・ループバックアドレス　そのノード自信を表すIPアドレス。127.0.0.1~127.255.255.254が該当するが、通常は127.0.0.1が使用される。

・サブネット　ネットワークを分割したより小さいネットワーク。元々クラスABCで分けられていたものを、より限定したネットワークにすることで管理が容易になる。

・サブネットマスク　IPv4にて、ネットワーク部とホスト部を識別するための値。

　○プレフィクス表記　サブネットマスクを１０進数表記にしたもの。

・デフォルトゲートウェイ　内部ネットワークと外部ネットワークを繋ぐためのネットワーク機器。通常はルータがコレに当たる。

・IPv6 IPv4の枯渇対策のために作成されたIPアドレス。16進数表記で32桁あり、16ビットごとに：で区切る。連続する０は一箇所のみ省略可能。トータル約340澗ほど割り当て可能。IPoE方式が利用可能。一応PPPoEもできる。

　[PPPoE方式](Point to Point over Ethernet)PPPをインターネット用に応用させたもの。ISPでネットワーク終端装置を必ず通過するが、ココがボトルネックになってしまい混雑時の輻輳の原因でもある。電話回線を利用した時代から通信時代から利用されている。上限1Gbps。

　[IPoE方式](Internet Protocol over Ethernet)ISPでネットワーク終端装置を通過せずに、大容量のゲートウェイルータを利用してインターネットに接続できる。そのため輻輳が発生しづらく、通信速度も速い。上限10Gbps。ただしIPv4のみに対応したWebサイトを閲覧できない。

　[IPoE IPv4 over IPv6]通常IPv6のIPoE方式を利用するが、必要に応じてIPv4に切り替えできる接続方式。コレでIPv4に切り替わってもネットワーク終端装置を通過しないため速度が低下しない。

　○サブネットプレフィクス　IPv4でのサブネットと同じ。前半６４ビットに当たる。ネットワークアドレスとサブネットアドレスを合わせたもの。

　○インターフェイスID　IPv6でホスト部を表す部分。後半６４ビットに当たる。

　[IPv6でのネットワークアドレス]　最初の４８ビットに当たる
　[IPv6でのサブネットアドレス]　最初から数えた４９〜６４ビット目までに当たる。
　[IPv6での装置アドレス]　後半の６４ビットに当たる。{インターフェースIDと同義か?}


・ルータ
　○コンソール接続　通信機器とPCをコンソールケーブルで接続する方式。ルータ側のコネクタはRJ45、PC側はDB-9となっている。ただし、昨今のPCで DB-9のポートはないのでUSB変換ケーブルを同時に利用する。ルータの初期設定時は必ずこの接続方式。{太古の昔はシリアルケーブルだった}

　○VTY接続　通信機器とPCをネットワークを通じて接続する方式。TelnetやSSHなどのプロトコルを利用する。ネットワーク管理者が物理的にアクセスする必要がないため、障害に発見が早まり可用性が高まると言える。
　[VTYライン]　VTY接続するための仮想的なインタフェースのこと。デフォルトは０〜４の５つ。

　○AUX接続　モデムを通じて電話回線やISDN回線を利用して通信機器とPCを接続する方式。(AUXとは補助という意味の英単語)。AUXポートのコネクタはRJ45。

　○ルーテイングテーブル　ルータ内に保存されている、宛先のIPアドレスとそこまでの最適経路の情報一覧。{スイッチでのMACアドレステーブルに近い}
　　>ネクストホップ　ノードに直接接続されているルータのIPアドレス。コレもルーティングテーブルに保存される。{ホップがルータの意味}
　　[メトリック]　ルータから宛先までのネットワークの距離を数値化したもの。ルーティングプロトコルによって算出方法が異なる。テーブルに保存される
　
　○ARPテーブル　ルータ内に保存されている、IPアドレスとMACアドレスの対応表。動的に得られた情報は一定時間後に消去されるが、静的に得られた情報はずっと残り続ける。
　　>ARP(Address Resolution Protocol) IPアドレスからネットワーク内のMACアドレスを求めるためのプロトコル。

　○コアルータ　ISPなどで、ネットワークの基幹部分位利用されるルータ。人の背丈を優に超える超巨大で、吸うギガビットの高速ネットワークを相互接続できる能力がある。価格として数千万円以上する。

　○センタールータ　WAN回線を介して本社と支社を相互接続するために利用されるルータ。よくスター型トポロジに利用されるため、この呼び方をされる。価格としては１００〜１０００万円ほど。

　○エッジルータ　支社に設置され、WAN回線を利用して本社のセンタルータに接続するためのルータ。本社から見た端(エッジ)のためこの呼び方。価格としては数万から１００万円ほど。

　○ブロードバンドルータ　家庭用のルータ。一般的にルータというとコレのことを指すことが多い。

　
・ルーティング

　○直接接続　ルータに隣接し、物理的にケーブルで接続されている状態。IPアドレスの設定とインタフェースが有効であれば、ルーティングテーブルに自動で登録される。

　○スタティックルーティング　直接接続されていないノードを、ルーティングテーブルに手動で登録する方法。ルータ自身の負荷は少なくなるが、経路内に障害が発生しても登録した経路にデータを転送し続けてしまう欠点がある。

　○ダイナミックルーティング　直接接続されていないノードを、ルーティングプロトコルを利用しルータ同士で情報交換することでルーティングテーブルに自動で登録する方法。経路内に障害発生時には、自動で最適経路を変更する。
　[ルーティングプロトコル]　ダイナミックルーティングで利用されるプロトコル。RIP,OSPF,EIGRP,BGPなどがある。
　[アドバタイズ]　ルーティングプロトコルを使ってルーティングテーブルを伝えること。

　　>ディスタンスベクタ型　距離(ディスタンス)と方向(ベクトル)により最適経路を決定するアルゴリズム。RIPがここで機能する。通過するホップ数が一番少ない箇所を最適経路として判断する。コンバージェンスまでに時間がかかることや、ルーティングループが発生しやすいというデメリットもある。30秒間隔で全ての経路情報をアップデートする。
　　[ルーティングループ]　循環経路内でIPパケットがぐるぐる回り続けてしまうこと。通常IPパケットにはTTLが設定されているため伝送容量を使い切ることはない。

　　>リンクステート型　ネットワーク内全てのルータから、どのルータと隣接しているかという接続情報(リンクステート)を交換し合い、最適経路を計算するアルゴリズム。OSPFやIS-ISがここで機能する。経路内での障害発生時に即座に対応し始めるためコンバージェンスが早い、ルーティングループが発生しないなどのメリットあり。
　　
　　>ハイブリッド型(拡張ディスタンスベクタ型)　Cisco独自のアルゴリズム。ルータ同士の情報交換する内容はディスタンスベクタと同じ。ネットワークに変更があった時のみ情報交換をする。交換した情報からDUALによって最適経路を決定する。EIGRPがここで機能する。
　　[DUAL](Diffusing Update ALgorithm) 最適ルートを決定したり、バックアップルートを選択するためのアルゴリズム。


・コネクション型通信　相手との通信経路が確立していることを確認してからデータを送り始める通信方式。信頼線の高い方式。TCPがコレに当たる。
　○[SYN](Synchronize)　接続を確立するためにクライアントが送信するパケット。 　　
　○ACK(Acknowledgement)　相手に返答するために送信されるパケット。要求を受理した、正しく受信できたといった内容を伝達する。　

・コネクションレス型通信　通信経路の確立をせずに、一方的にデータを送りつける通信方式。通信速度が速い。UDPがコレに当たる。ストリーミング技術で利用される。
　
　○TCP(Transmission Control Protocol)　OSIでのL4で機能するプロトコル。信頼性の高い通信を行う。TCPデータをセグメントと呼ぶ。

　○スリーウェイハンドシェイク　TCPでコネクション確立のために行う手順。パケットの送受信を３回することからこう呼ぶ。

　○Telnet ノードを遠隔操作するためのプロトコル。IDとパスワードが必ず必要となるが、セキュリティ面で脆弱のためSSHを使うことがほとんど。
　　[SSH](Secure Shell)　暗号化した状態で遠隔操作するためのプロトコル。TCPを利用している。

  ○HTTP(Hyper Text Transfer Protocol)　Webサーバとブラウザの間で情報交換するためのプロトコル。HTML文書などを読み取るために必要。これを暗号化させたものがHTTPS。TCPを利用している。

  ○FTP(File Transfer Protocol) サーバーとクライアントの間でファイル転送を行うためのプロトコル。これを暗号化させたものがSFTPやFTPSという。TCPを利用している。

  ○SMTP(Simple Mail Transfer Protocol)　サーバーにメール(メッセージ)を送信するためのプロトコル。TCPを利用している。
　[POP](Post Office Protocol)　サーバーからメールを受信するためのプロトコル。
　[IMAP](Internet Message Access Protocol) メールをサーバーに保管するプロトコル。

・TCPヘッダ　TCPセグメントに付加されるヘッダ。20バイト。
[内訳]>送信元ポート番号(16bit)、宛先ポート番号(16bit)
　　>シーケンス番号(32bit)　送信したデータの順序を表す
　　>確認応答番号(32bit)　相手から受信したシーケンス番号＋データサイズを表す
　　>データオフセット(4bit)　TCPヘッダの長さを表す
　　>予約(3bit)　今はまだ使われていない、将来拡張用に用意されている部分。全て0が入る。
　　>コントロールフラグ(9bit)　NS,CWR,ECE,URG,ACK,PSH,RST,SYN,FINの9ビットで構成される。それぞれ1が入る場合に意味をなす。
　　>ウインドウサイズ(16bit)　受信側が一度に受信できるデータサイズを送信側に通知するために利用される。　
　　>チェックサム(16bit)　TCPヘッダとデータ部分のエラーチェックするための値。
　　>緊急ポインタ(16bit)　コントロールフラグのURGが1の時のみ使用される。緊急データの開始位置を示す。
　　>オプション(可変調)　TCPの通信で性能を向上させるために利用する。コネクションの際に、MSSを決定するために使用することがある。
　　>パディング(可変調)　TCPヘッダのサイズを32ビットの倍数にするための空データ

[コントロールフラグの内訳]
　　>NS　ECN-nonce　輻輳保護を示す
　　>CWR(Congestion Window Reduced)　輻輳制御ウィンドウ縮小を示す
　　>ECE　ECN-Echoを示す。SYNフラグがセットされている場合、ECNが利用であることを意味する。
　　>URG(Urgent)　緊急に処理すべきデータが含まれていることを示す。
　　>ACK(Acknowledgement)　確認応答番号のフィールドが有効であることを示す。コネクション確立時以外は１。
　　>PSH(Push)　受信したデータをバッファリングせずに、即座にアプリケーションに渡すことを示す。
　　>RST(Reset)　コネクションが強制的に切断されることを示す。何らかの異常を検出した場合に送信される。
　　>SYN(Synchronize)　コネクションの確立を要求することを示す。
　　>FIN(Fin)　コネクションの正常な終了を要求することを示す。
　　[ECN](Explicit Congestion Notification)　ネットワークの服装をエンドノードに伝える仕組み。

・UDP(User Datagram Protocol)　OSIでのL4で機能するプロトコル。信頼性は低いが転送速度の速い通信を行う。VoIPや動画や音声の再生でよく使われる。UDPデータをデータグラムと呼ぶ。DNSやNTPもコレ。UDPは通信の確立をしないため、悪用してDdos攻撃に利用されることもある。

  ○RTP(Realtime Transport Protocol)　動画や音声をリアルタイムに伝送するための通信プロトコル。UDPを用いる。IETFによって1996年にRFC1889として定められ、のちに暗号化されたものが2003年RFC3550で定められた。TCP/IPでいうアプリケーション層で機能する。

  ○SNMP(Simple Network Management Protocol)　TCP/IPネットワーク環境の監視・管理を担うプロトコル。OSIではL7で機能するUDPを利用している

  ○DHCP(Dynamic Host Configuration Protocol)　IPアドレスを自動で割り当てるためのプロトコル。OSIではL7で機能する。UDPを利用している。

  ○TFTP(Tribal File Transfer protocol)　コンピューター間でファイル転送する際に利用されるプロトコル。UDPを利用したFTPっぽいもの。FTPと違い、ユーザ名とパスワード認証をしない。OSIでのL7で機能する。

  ○RIP(Routing Information Protocol)　ルーティングプロトコルの一種。その中でも最も古い。ディスタンスベクタ型で利用される。TCP/IPでのアプリケーション層で機能する。UDPを利用している。

・UDPヘッダ　L4で付加されるUDPのヘッダ。8byte。
[内訳]>送信元ポート番号(16bit)　宛先ポート番号(16bit)
　　>パケット長(16bit)　UDPヘッダとUDPデータの長さを表す。
　　>チェックサム(16bit)　UDPヘッダとデータ部分のエラーをチェックするための値。